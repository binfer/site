---
title: "Phpexcel"
date: 2020-07-24T10:16:26+08:00
tags : ["php"]
---
#### ![*](https://img.shields.io/static/v1?label=smoke&message=<PHPEXCEL>&color=yellowgreen&style=for-the-badge&logo=appveyor&suffix=download&?link=http://left&link=http://google.com)
``
导出百万级的方案网上给出的比较多　我目前整理了３种可供参考的。
１．php打开缓冲区进行写入导出，适用于phpexcel之类的第三方包，性能一般，适合复杂业务　　　
２．php运行mysql直接借助mysql导出，性能高，不适合复杂业务　　
３: php扩展导出，性能比较好适合多业务

采用csv格式导出，　excel有数据行限制，几百万数据基本打不开。

——————————————————————————————————————————————————————————————————

10:29:22 当前使用的缓存方法是： MemoryGZip 方式			
10:29:24 当前模拟数据( 1000000 ) 条			
10:30:09--- 耗时: 46.661 秒			
10:30:09--- 消耗内存: 1438.7 MB			
10:30:09--- 内存使用峰值: 1348.16015625 MB			
10:30:09--- 完成写入文件			
10:30:09--- 文件被创建在： /www/wwwroot/www.new.food/food/public目录			

———————————————————————————————————————————————————————————————————
10:31:46 当前使用的缓存方法是： Memory 方式			
10:31:48 当前模拟数据( 1000000 ) 条			
10:32:03--- 耗时: 17.586 秒			
10:32:03--- 消耗内存: 1454.33 MB			
10:32:03--- 内存使用峰值: 1454.16015625 MB			
10:32:03--- 完成写入文件			
10:32:03--- 文件被创建在： /www/wwwroot/www.new.food/food/public目录			

————————————————————————————————————————————————————————————————————
10:33:09 当前使用的缓存方法是： PHPTemp 方式			
10:33:11 当前模拟数据( 1000000 ) 条			
10:33:26--- 耗时: 17.729 秒			
10:33:26--- 消耗内存: 1614.19 MB			
10:33:26--- 内存使用峰值: 1426.16015625 MB			
10:33:26--- 完成写入文件			
10:33:26--- 文件被创建在： /www/wwwroot/www.new.food/food/public目录			
————————————————————————————————————————————————————————————————————

10:40:25 当前使用的缓存方法是： DiscISAM 方式			
10:40:28 当前模拟数据( 1000000 ) 条			
10:40:43--- 耗时: 17.64 秒			
10:40:43--- 消耗内存: 1614.21 MB			
10:40:43--- 内存使用峰值: 1278.16015625 MB			
10:40:43--- 完成写入文件			
10:40:43--- 文件被创建在： /www/wwwroot/www.new.food/food/public目录			
————————————————————————————————————————————————————————————————————

10:39:42 当前使用的缓存方法是： MemorySerialized 方式			
10:39:44 当前模拟数据( 1000000 ) 条			
10:39:57--- 耗时: 14.748 秒			
10:39:57--- 消耗内存: 5161.86 MB			
10:39:57--- 内存使用峰值: 4758.16015625 MB			
10:39:57--- 完成写入文件			
10:39:57--- 文件被创建在： /www/wwwroot/www.new.food/food/public目录			
————————————————————————————————————————————————————————————————————
11:56:11 当前使用的缓存方法是：putcsv 方式 　　(未使用缓冲，仅使用迭代)
11:56:11 当前模拟数据( 1000000 ) 条 
11:57:01--- 耗时: 50.216 秒 
11:57:01--- 消耗内存: 546.16 MB 
11:57:01--- 内存使用峰值: 208.16015625 MB 
11:57:01--- 完成写入文件 11:57:01--- 文件被创建在： /www/wwwroot/www.new.food/food/public/.

————————————————————————————————————————————————————————————————————
11:56:15 当前使用的缓存方法是：putcsv 方式 　　(使用缓冲和迭代)
11:59:15--- 耗时: 51.022 秒
11:59:15--- 消耗内存: 546.15 MB
11:59:15--- 内存使用峰值: 1114.16015625 MB
11:59:15--- 完成写入文件
11:59:15--- 文件被创建在： /www/wwwroot/www.new.food/food/public/../20200721115824.csv目录



			
--- 耗时: 27.906 秒	
--- 消耗内存: 2039.1 MB	
--- 内存使用峰值: 1288 MB
``